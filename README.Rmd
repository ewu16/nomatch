---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)

library(tibble)
```

# R/`nomatch`

> A matching alternative for more efficiently evaluating effectiveness of interventions using observational data


## Description

The `nomatch` package uses a G-computation style estimator to compute effectiveness of binary interventions from observational cohort studies following the target trial emulation framework. The proposed estimator tends to produce similar point estimates as matching-based estimators but can be more efficient.

## Installation

You can install the development version of `nomatch` with:

``` r
# install.packages("devtools")
devtools::install_github("ewu16/nomatch")
```

## Example

This minimal example shows how to use `nomatch` to obtain cumulative incidences and 
their derived effect measures such as risk differences (RD), risk ratios (RR), and  vaccine effectiveness (VE = 1 - RR).

We use a simple simulated dataset mimicking data from an observational vaccine study,
although the methods apply equally to other disease settings. 

```{r example, fig.width = 8, fig.height = 4}

#Load package
library(nomatch)

# Example data
simdata <- as_tibble(simdata) #for prettier printing 

#View data
head(simdata)
```

Note that the dataset contains the following:

-  one row per individual (`ID`)

-  a set of baseline covariates (`x1`, `x2`)

-  exposure status (`V`) with values `1 = vaccinated, 0 = unvaccinated`. (Note: its currently
assumed that the unexposed group does not receive an active comparator.) 

-  time to vaccination (`D_obs`); for unvaccinated individuals this is left as `NA`. 

- right censored survival data `(Y, event)` 
   - `Y` represents follow-up time for an outcome such as infection, hospitalization or death.
   - `event` indicates whether individual experienced the event or censoring with values `1 = event, 0 = censored`.


```{r}

# Compute cumulative incidence and effect measures 
fit <- nomatch(data = simdata,
               outcome_time = "Y",
               outcome_status = "event",
               exposure = "V",
               exposure_time = "D_obs", 
               covariates = c("x1", "x2"),
               immune_lag = 14,
               eval_times = seq(30, 180, by = 30),
               effect = "vaccine_effectiveness", 
               boot_reps = 10)

# Print main results 
## - Note by default only the chosen effect measure is printed
## but all effect measures are computed and stored in the fitted object 
fit        

# View additional details about the analytic approach 
summary(fit)

# Plot cumulative incidence and effect measures over time 
plot(fit) 
```


## Issues

If you encounter any bugs or have any specific feature requests, please [file an issue](https://github.com/ewu16/nomatch/issues).

## Citation

If you use the `nomatch` package in your work, please cite the following:

```{r, include = FALSE}
c <- citation("nomatch")
toBibtex(c)
```

```
 @Manual{,
   title = {nomatch: Estimate Effectiveness of Interventions in Target Trial Emulation Observational Studies
             Without Matching},
   author = {Emily Wu},
   year = {2025},
   note = {R package version 0.0.0.9000, 
   https://github.com/ewu16/nomatch},
   url = {https://ewu16.github.io/nomatch/},
 }
 ```
 

